"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "Policy", {
  enumerable: true,
  get: function get() {
    return _policy["default"];
  }
});
exports.checkAuthority = void 0;

var _policy = _interopRequireDefault(require("@pansy/policy"));

var _isArray = _interopRequireDefault(require("@pansy/is-array"));

var _isString = _interopRequireDefault(require("@pansy/is-string"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

/**
 * 权限检查方法
 * @param { 权限判定 | Permission judgment } authority
 * @param { 权限验证方法 | no pass components } policy
 */
var checkAuthority = function checkAuthority(policy, authority) {
  var result = true; // 数组处理

  if ((0, _isArray["default"])(authority)) {
    if (!policy.multipleVerify(authority)) {
      result = false;
    }
  } // string 处理


  if ((0, _isString["default"])(authority)) {
    if (!policy.combinationVerify(authority)) {
      result = false;
    }
  }

  return result;
};

exports.checkAuthority = checkAuthority;
//# sourceMappingURL=check-authority.js.map
